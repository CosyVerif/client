<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">
  <head>
    <title>Lua scratch</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
    <script type="text/javascript" src="js/d3/d3.js"></script>
    <script src="js/lua.vm/lua.vm.js"></script>
    <script type="text/lua">
local request = function (url)
  local request = _G.js.new (_G.js.global.XMLHttpRequest)
  request:open ("GET", url, false)
  request:send (nil)
  if request.status == 200 then
    return request.responseText, request.status
  else
    return nil, request.status
  end
end

package.searchers = {}
table.insert (package.searchers, 1, function (name)
  local url = "lua/" .. name .. ".lua"
  local result, err = request (url)
  if not result then
    error (err)
  end
  print (result)
  return load (result, url)
end)

require 'visualiser'
    </script>
  </head>
  <body>
    <h1 style="text-size: -4;">Lua scratch</h1>
  </body>
</html>
